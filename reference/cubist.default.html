<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a Cubist model — cubist.default • Cubist</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fit a Cubist model — cubist.default"><meta property="og:description" content="This function fits the rule-based model described in Quinlan
(1992) (aka M5) with additional corrections based on nearest
neighbors in the training set, as described in Quinlan (1993a)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Cubist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/cubist.html">Introduction</a>
</li>
<li>
  <a href="../articles/extras/tuning.html">Tuning</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/topepo/Cubist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Cubist model</h1>
    <small class="dont-index">Source: <a href="https://github.com/topepo/Cubist/blob/HEAD/R/cubist.R" class="external-link"><code>R/cubist.R</code></a></small>
    <div class="hidden name"><code>cubist.default.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function fits the rule-based model described in Quinlan
(1992) (aka M5) with additional corrections based on nearest
neighbors in the training set, as described in Quinlan (1993a).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">cubist</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, committees <span class="op">=</span> <span class="fl">1</span>, control <span class="op">=</span> <span class="fu"><a href="cubistControl.html">cubistControl</a></span><span class="op">(</span><span class="op">)</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a matrix or data frame of predictor variables. Missing
data are allowed but (at this time) only numeric, character and
factor values are allowed. Must have column names.</p></dd>


<dt>y</dt>
<dd><p>a numeric vector of outcome</p></dd>


<dt>committees</dt>
<dd><p>an integer: how many committee models (e.g..
boosting iterations) should be used?</p></dd>


<dt>control</dt>
<dd><p>options that control details of the <code>cubist</code>
algorithm. See <code><a href="cubistControl.html">cubistControl()</a></code></p></dd>


<dt>weights</dt>
<dd><p>an optional vector of case weights (the same
length as <code>y</code>) for how much each instance should contribute to
the model fit. From the RuleQuest website: "The relative
weight assigned to each case is its value of this attribute
divided by the average value; if the value is undefined, not
applicable, or is less than or equal to zero, the case's
relative weight is set to 1."</p></dd>


<dt>...</dt>
<dd><p>optional arguments to pass (not currently used)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>an object of class <code>cubist</code> with elements:</p>
<dl><dt>data, names, model</dt>
<dd><p>character strings that correspond to
their counterparts for the command-line program available from
RuleQuest</p></dd>

<dt>output</dt>
<dd><p>basic cubist output captured from the C code,
including the rules, their terminal models and variable usage
statistics</p></dd>

<dt>control</dt>
<dd><p>a list of control parameters passed in by the
user</p></dd>

<dt>composite, neighbors, committees</dt>
<dd><p>mirrors of the values to
these arguments that were passed in by the user</p></dd>

<dt>dims</dt>
<dd><p>the output if <code>dim(x)</code></p></dd>

<dt>splits</dt>
<dd><p>information about the variables and values used in
the rule conditions</p></dd>

<dt>call</dt>
<dd><p>the function call</p></dd>

<dt>coefs</dt>
<dd><p>a data frame of regression coefficients for each
rule within each committee</p></dd>

<dt>vars</dt>
<dd><p>a list with elements <code>all</code> and <code>used</code> listing the
predictors passed into the function and used by any rule or
model</p></dd>

<dt>fitted.values</dt>
<dd><p>a numeric vector of predictions on the
training set.</p></dd>

<dt>usage</dt>
<dd><p>a data frame with the percent of models where each
variable was used. See <code><a href="summary.cubist.html">summary.cubist()</a></code> for a discussion.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Cubist is a prediction-oriented regression model that combines
the ideas in Quinlan (1992) and Quinlan (1993).</p>
<p>Although it initially creates a tree structure, it collapses
each path through the tree into a rule. A regression model is
fit for each rule based on the data subset defined by the rules.
The set of rules are pruned or possibly combined. and the
candidate variables for the linear regression models are the
predictors that were used in the parts of the rule that were
pruned away. This part of the algorithm is consistent with the
"M5" or Model Tree approach.</p>
<p>Cubist generalizes this model to add boosting (when
<code>committees &gt; 1</code>) and instance based corrections (see
<code><a href="predict.cubist.html">predict.cubist()</a></code>). The number of instances is set at
prediction time by the user and is not needed for model
building.</p>
<p>This function links R to the GPL version of the C code given on
the RuleQuest website.</p>
<p>The RuleQuest code differentiates missing values from values
that are not applicable. Currently, this packages does not make
such a distinction (all values are treated as missing). This
will produce slightly different results.</p>
<p>To tune the cubist model over the number of committees and
neighbors, the <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train()</a></code> function in the <code>caret</code> package
has bindings to find appropriate settings of these parameters.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Quinlan. Learning with continuous classes.
Proceedings of the 5th Australian Joint Conference On Artificial
Intelligence (1992) pp. 343-348</p>
<p>Quinlan. Combining instance-based and model-based learning.
Proceedings of the Tenth International Conference on Machine
Learning (1993a) pp. 236-243</p>
<p>Quinlan. <strong>C4.5: Programs For Machine Learning</strong> (1993b)
Morgan Kaufmann Publishers Inc. San Francisco, CA</p>
<p>Wang and Witten. Inducing model trees for continuous classes.
Proceedings of the Ninth European Conference on Machine Learning
(1997) pp. 128-137</p>
<p><a href="http://rulequest.com/cubist-info.html" class="external-link">http://rulequest.com/cubist-info.html</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="cubistControl.html">cubistControl()</a></code>, <code><a href="predict.cubist.html">predict.cubist()</a></code>,
<code><a href="summary.cubist.html">summary.cubist()</a></code>, <code><a href="dotplot.cubist.html">dotplot.cubist()</a></code>, <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>R code by Max Kuhn, original C sources by R Quinlan and
modifications be Steve Weston</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BostonHousing</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1 committee, so just an M5 fit:</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">cubist</span><span class="op">(</span>x <span class="op">=</span> <span class="va">BostonHousing</span><span class="op">[</span>, <span class="op">-</span><span class="fl">14</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">BostonHousing</span><span class="op">$</span><span class="va">medv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cubist.default(x = BostonHousing[, -14], y = BostonHousing$medv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of samples: 506 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of predictors: 13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of committees: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of rules: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now with 10 committees</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">cubist</span><span class="op">(</span>x <span class="op">=</span> <span class="va">BostonHousing</span><span class="op">[</span>, <span class="op">-</span><span class="fl">14</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">BostonHousing</span><span class="op">$</span><span class="va">medv</span>, committees <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cubist.default(x = BostonHousing[, -14], y = BostonHousing$medv, committees</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of samples: 506 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of predictors: 13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of committees: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of rules per committee: 4, 6, 4, 6, 6, 7, 7, 7, 4, 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Max Kuhn, Ross Quinlan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

